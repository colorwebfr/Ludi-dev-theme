$(document).ready(function(){function e(){var e=$(".a-selectionner").length;0==e?$("#nombre_fichiers").html(""):$("#nombre_fichiers").html(" ("+e+" fichiers sélectionnés)")}$(".draggable").draggable({revert:"invalid",helper:"clone",cursor:"move"}),$(".selectionnes").droppable({classes:{"ui-droppable-active":"selectionnes-hover"},drop:function(t,i){var s=i.draggable[0].id;i.draggable[0].dataset.fichier,i.draggable[0].innerHTML;$("#"+s).addClass("jeu-selectionne"),$("#"+s).clone().removeClass("jeu-selectionne").addClass("a-selectionner").attr("id","select-"+s).attr("data-id",s).append('<i class="annuler fas fa-times-circle"></i>').appendTo($("#jeux-selectionnes")),e()}}),$(document).on("click","#bouton-valider",function(){if($("#erreur").hide(),$(".loading").show(),0==$(".a-selectionner").length)alert("Veuillez sélectionner des fichiers");else{var t=[];$.each($(".a-selectionner"),function(){var e=$(this).data("id"),i=$(this).data("fichier");t.push({id:e,nom:i})}),$.ajax({url:"processFichiers.php",type:"POST",data:{donnees:t}}).success(function(t){$(".loading").hide(),"ko"==t?$("#erreur").show():($("#jeux-selectionnes").empty(),$(".jeu-selectionne").removeClass("jeu-selectionne"),e(),window.location.href=t)}).error(function(){$(".loading").hide(),$("#erreur").show()})}}),$(document).on("click",".choix-lettre",function(){var e=$(this).data("lettre");$(this).hasClass("lettre-active")?($(".choix-lettre").removeClass("lettre-active"),$(".choix-lettre").removeClass("lettre-inactive"),$(".jeu").removeClass("hide")):($(this).hasClass("lettre-inactive")?($(".lettre-active").removeClass("lettre-active").addClass("lettre-inactive"),$(this).removeClass("lettre-inactive").addClass("lettre-active")):($(".choix-lettre").not($(this)).addClass("lettre-inactive"),$(this).addClass("lettre-active")),$.each($(".jeu"),function(){$(this).html().charAt(0).toLowerCase()==e?$(this).removeClass("hide"):$(this).addClass("hide")}))}),$(document).on("click",".annuler",function(){var t=$(this).parent(),i=t.data("id");$("#"+i).removeClass("jeu-selectionne"),t.remove(),e()}),$(document).on("keyup","#recherche",function(){$(".choix-lettre").removeClass("lettre-active"),$(".choix-lettre").removeClass("lettre-inactive"),$(".jeu").removeClass("hide");var e=$(this).val().toLowerCase();$.each($(".jeu"),function(){-1!==$(this).html().toLowerCase().indexOf(e)?$(this).removeClass("hide"):$(this).addClass("hide")})})});